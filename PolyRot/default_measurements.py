"""
Default values for common ring lengths, deflection angles, bond lengths, etc. All lengths
are given in Angstroms and all angles are given in degrees. 

It is recommended that users find exact values via calculations or literature review.
"""


def bond_length(atom1="C", atom2="C", bond_order=1):
    """
    Get default value for bond length
    :param atom1: str, element abbreviation 1 ('aro' for aromatic)
    :param atom2: str, element abbreviation 2 ('aro' for aromatic)
    :param bond_order: float, bond order (1=single, 1.5=aromatic, 2=double, 3=triple)

    :return: float, bond length in Angstroms
    """
    bond_orders = {1: "_", 1.5: "--", 2: "=", 3: "-="}

    bond_id1 = "{}{}{}".format(atom1.capitalize(), bond_orders.get(bond_order), atom2.capitalize())
    bond_id2 = "{}{}{}".format(atom2.capitalize(), bond_orders.get(bond_order), atom1.capitalize())

    bond_lengths = {
        "C_C": 1.54,
        "C_N": 1.47,
        "C_O": 1.43,
        "aro_C":  1.52,
        "aro_N": 1.42,
        "C_H": 1.09,
        "N_H": 0.99,
        "C_F": 1.37,
        "C_Cl": 1.76,
        "C_Br": 1.94,
        "C_I": 2.14,
        "C_S": 1.82,
        "C_P": 1.84,
        "O_H": 0.98,
        "S_S": 2.07,

        "C--C": 1.40,
        "C--N": 1.34,
        "N--N": 1.35,

        "C=C": 1.34,
        "C=O": 1.21,
        "C=N": 1.25,
        "N=N": 1.25,

        "C-=C": 1.20,
        "C-=N": 1.16,
    }
    return bond_lengths.get(bond_id1) or bond_lengths.get(bond_id2)


def ring_length(ring_size=None, ring_name=None):
    """
    Get default value for ring length. If given ring_name not in available rings, this will
    default to ring size method.

    :param ring_size: int, number of atoms in ring (produces a very rough estimate)
    :param ring_name: str, ring name (limited to available rings)

    :return: float, ring length in Angstroms
    """
    ring_names = {
        "thiophene": 2.52,
        "thiazole": 2.36,
        "pyrimidine": 2.71,
        "phenyl": 2.85,
        "pyridine": 2.78,
        "fluorene": 6.95,
        "benzothiadizole": 2.97,
    }
    ring_sizes = {
        5: 2.4,
        6: 2.8,
    }
    return ring_names.get(ring_name) or ring_sizes.get(ring_size)


def deflection_angle(ring_size=None, ring_name=None):
    """
    Get default value for ring length. If given ring_name not in available rings, this will
    default to ring size method.

    :param ring_size: int, number of atoms in ring
    :param ring_name: str, ring name (limited to available rings)

    :return: float, deflection angle in degrees
    """
    ring_names = {
      "thiazole": 13,
      "thiophene": 16,
      "phenyl": 0.1,
      "pyrimidine": 1,
      "pyridine": 3,
      "fluorene": 11,
      "benzothiadizole": 1.4,
    }
    ring_sizes = {
        5: 18,
        6: 1,
    }
    return ring_names.get(ring_name) or ring_sizes.get(ring_size)


def pes_by_class(class_name):
    """
    Get average potential energy surface (PES) for a given class or subclass
    :param class_name: str, class or subclass name

    :return: list of tuples where each tuple is [dihedral angle (degree), relative energy (kcal/mol)]
    """
    classes = {'central_peak': [[0, 0.0131876847], [10, 0.016300252], [20, 0.0277053079], [30, 0.0500202713],
                                [40, 0.0834258196], [50, 0.1246323308], [60, 0.1675022118], [70, 0.2046118773],
                                [80, 0.2294462626], [90, 0.2380755566], [100, 0.2294744746], [110, 0.2052745182],
                                [120, 0.169488132], [130, 0.1277333011], [140, 0.0861663613], [150, 0.0502707399],
                                [160, 0.0237901911], [170, 0.0081836554], [180, 0.0032576672]],
               'tilted': [[0, 0.22198569], [10, 0.2118478634], [20, 0.1888588676], [30, 0.167275471],
                          [40, 0.1585655372], [50, 0.166031149], [60, 0.1845006259], [70, 0.2046224063],
                          [80, 0.2181923326], [90, 0.2202466976], [100, 0.2090219876], [110, 0.1856288012],
                          [120, 0.1534256669], [130, 0.1168391589], [140, 0.0803631011], [150, 0.0481268965],
                          [160, 0.0233629827], [170, 0.0080670701], [180, 0.0030878211]],
               'rolling_hill': [[0, 0.0373180031], [10, 0.0324424937], [20, 0.0220216479], [30, 0.015162388],
                                [40, 0.0179205627], [50, 0.0307428227], [60, 0.0497226422], [70, 0.0691523628],
                                [80, 0.0834568066], [90, 0.0886055995], [100, 0.0831695325], [110, 0.068517329],
                                [120, 0.0484693273], [130, 0.0283409969], [140, 0.0136183206], [150, 0.0083517419],
                                [160, 0.012702104], [170, 0.0213940517], [180, 0.0261351401]],
               'w_shaped': [[180, 0.0998795361], [170, 0.0880531363], [160, 0.067449851], [150, 0.054266746],
                            [140, 0.0570329903], [130, 0.075900743], [120, 0.1044351258], [110, 0.1331607232],
                            [100, 0.15404921], [90, 0.1622555463], [80, 0.1565248833], [70, 0.1393040754],
                            [60, 0.1171309843], [50, 0.1004153359], [40, 0.0998647904], [30, 0.1208687629],
                            [20, 0.1599656563], [10, 0.2034300621], [0, 0.225790553]]}
    subclasses = {
        'small_peak': [[0, 0.0148662706], [10, 0.0151347832], [20, 0.0184626685], [30, 0.02925018], [40, 0.0496235134],
                       [50, 0.0776007042], [60, 0.1082282214], [70, 0.1355871363], [80, 0.1542765688],
                       [90, 0.1605485434], [100, 0.1530615722], [110, 0.1331521539], [120, 0.1045829532],
                       [130, 0.0727640664], [140, 0.0435008174], [150, 0.0215469611], [160, 0.0089185832],
                       [170, 0.0039104269], [180, 0.0028608205]],
        'high_peak': [[180, 0.0], [170, 0.0112282227], [160, 0.0431120897], [150, 0.091313342], [140, 0.1497577544],
                      [130, 0.2114805987], [120, 0.2691502308], [110, 0.3158536613], [100, 0.3461091288],
                      [90, 0.3565788214], [80, 0.346281518], [70, 0.3164463429], [60, 0.2704757253], [50, 0.2137045543],
                      [40, 0.1527430305], [30, 0.0947744416], [20, 0.0467794121], [10, 0.0149450698],
                      [0, 0.0036909815]],
        'w_high': [[180, 0.2343393719], [170, 0.2012036903], [160, 0.1329302612], [150, 0.0661382329],
                   [140, 0.0228499942], [130, 0.0084280468], [120, 0.0160536729], [110, 0.0327370108],
                   [100, 0.047735978], [90, 0.0523538744], [80, 0.0452030022], [70, 0.03202816], [60, 0.0154131247],
                   [50, 0.0137617227], [40, 0.043557424], [30, 0.1104935183], [20, 0.2067308719], [10, 0.3070017672],
                   [0, 0.3599216394]],
        'welled_tilted': [[0, 0.2290975639], [10, 0.2092528416], [20, 0.1701875553], [30, 0.1294121403],
                          [40, 0.1046748365], [50, 0.1025014779], [60, 0.1122891173], [70, 0.1323919838],
                          [80, 0.1476904618], [90, 0.152731095], [100, 0.1458738832], [110, 0.1282926539],
                          [120, 0.1036151908], [130, 0.0759987435], [140, 0.0495226058], [150, 0.028022296],
                          [160, 0.0141585221], [170, 0.0078361945], [180, 0.0071353724]],
        'w_small': [[0, 0.1353966201], [10, 0.1194401783], [20, 0.0824536135], [30, 0.0461641231], [40, 0.0271645998],
                    [50, 0.0296018569], [60, 0.0469657539], [70, 0.0689490481], [80, 0.0857797173], [90, 0.0905592569],
                    [100, 0.0806571577], [110, 0.0578909508], [120, 0.0289540011], [130, 0.0053669929],
                    [140, 0.0001431456], [150, 0.0208981137], [160, 0.0636894178], [170, 0.110090263],
                    [180, 0.1320371959]],
        'non_welled_tilted': [[0, 0.1687306345], [10, 0.1663631321], [20, 0.1634252658], [30, 0.1655607127],
                              [40, 0.1765091776], [50, 0.1960799101], [60, 0.2203168592], [70, 0.2430524493],
                              [80, 0.2580386919], [90, 0.2606372349], [100, 0.2486109532], [110, 0.2223452032],
                              [120, 0.1847981742], [130, 0.1412392949], [140, 0.0979937209], [150, 0.0605415237],
                              [160, 0.0305311783], [170, 0.0117634094], [180, 0.0094418388]],
        'rolling_hill': [[180, 0.0269088462], [170, 0.0219658118], [160, 0.0123588192], [150, 0.005760288],
                         [140, 0.0070958313], [130, 0.0166794278], [120, 0.0314567322], [110, 0.0469959304],
                         [100, 0.0588098083], [90, 0.0634096039], [80, 0.0595117652], [70, 0.0484806816],
                         [60, 0.0340622781], [50, 0.0209579423], [40, 0.0136684087], [30, 0.0149430703],
                         [20, 0.0238305837], [10, 0.0347463066], [0, 0.0395887191]]}

    return subclasses.get(class_name) or classes.get(class_name, [])


if __name__=="__main__":
    print(ring_length(ring_size=5))
    print(bond_length(atom1="C", atom2="C", bond_order=1.5))
    print(deflection_angle(ring_size=5))
    print(pes_by_class("w_high"))
